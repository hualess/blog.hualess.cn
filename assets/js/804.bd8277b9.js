(window.webpackJsonp=window.webpackJsonp||[]).push([[804],{1389:function(a,s,t){"use strict";t.r(s);var r=t(2),e=Object(r.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"_0x-00-前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x-00-前言"}},[a._v("#")]),a._v(" 0x 00 前言")]),a._v(" "),t("h3",{attrs:{id:"当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时-急需第一时间进行处理-使"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时-急需第一时间进行处理-使"}},[a._v("#")]),a._v(" 当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时，急需第一时间进行处理，使")]),a._v(" "),t("h3",{attrs:{id:"企业的网络信息系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#企业的网络信息系"}},[a._v("#")]),a._v(" 企业的网络信息系")]),a._v(" "),t("h3",{attrs:{id:"统在最短时间内恢复正常工作-进一步查找入侵来源-还原入侵事故过程-同时给出解决方案与防范"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#统在最短时间内恢复正常工作-进一步查找入侵来源-还原入侵事故过程-同时给出解决方案与防范"}},[a._v("#")]),a._v(" 统在最短时间内恢复正常工作，进一步查找入侵来源，还原入侵事故过程，同时给出解决方案与防范")]),a._v(" "),t("h3",{attrs:{id:"措施-为企业挽回"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#措施-为企业挽回"}},[a._v("#")]),a._v(" 措施，为企业挽回")]),a._v(" "),t("h3",{attrs:{id:"或减少经济损失。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#或减少经济损失。"}},[a._v("#")]),a._v(" 或减少经济损失。")]),a._v(" "),t("h3",{attrs:{id:"针对常⻅的攻击事件-结合工作中应急响应事件分析和解决的方法-总结了一些linux服务器入侵排查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#针对常⻅的攻击事件-结合工作中应急响应事件分析和解决的方法-总结了一些linux服务器入侵排查"}},[a._v("#")]),a._v(" 针对常⻅的攻击事件，结合工作中应急响应事件分析和解决的方法，总结了一些Linux服务器入侵排查")]),a._v(" "),t("h3",{attrs:{id:"的思路。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#的思路。"}},[a._v("#")]),a._v(" 的思路。")]),a._v(" "),t("h1",{attrs:{id:"_0x-01-入侵排查思路"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x-01-入侵排查思路"}},[a._v("#")]),a._v(" 0x 01 入侵排查思路")]),a._v(" "),t("h2",{attrs:{id:"_1-1-账号安全"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-账号安全"}},[a._v("#")]),a._v(" 1. 1 账号安全")]),a._v(" "),t("h3",{attrs:{id:"基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[a._v("#")]),a._v(" 基本使用：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 1 、用户信息文件/etc/passwd\n2 root:x: 0 : 0 :root:/root:/bin/bash\n3 account:password:UID:GID:GECOS:directory:shell\n4 用户名：密码：用户ID：组ID：用户说明：家目录：登陆之后shell\n5 注意：无密码只允许本机登陆，远程不允许登陆\n6 2 、影子文件/etc/shadow\n7 root:$ 6 $oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft\n8 9 ajBwUt1DpYxTCVvI/: 16809 : 0 : 99999 : 7 :::\n9 用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天\n10 后的宽限天数：账号失效时间：保留\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 who 查看当前登录用户（tty本地登陆 pts远程登录）\n2 w 查看系统信息，想知道某一时刻用户的行为\n3 uptime 查看登陆多久、多少用户，负载\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"入侵排查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#入侵排查"}},[a._v("#")]),a._v(" 入侵排查：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 1 、查询特权用户特权用户(uid 为 0 )\n2 [root@localhost ~]# awk -F: '$3==0{print $1}' /etc/passwd\n3 2 、查询可以远程登录的帐号信息\n4 [root@localhost ~]# awk '/\\$1|\\$6/{print $1}' /etc/shadow\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('5 3 、除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限\n6 [root@localhost ~]# more /etc/sudoers | grep -v "^#\\|^$" | grep "ALL=(ALL)"\n7 4 、禁用或删除多余及可疑的帐号\n8 usermod -L user 禁用帐号，帐号无法登录，/etc/shadow第二栏为!开头\n9 userdel user 删除user用户\n10 userdel -r user 将删除user用户，并且将/home目录下的user目录一并删除\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h2",{attrs:{id:"_1-2-历史命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-历史命令"}},[a._v("#")]),a._v(" 1. 2 历史命令")]),a._v(" "),t("h3",{attrs:{id:"基本使用-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用-2"}},[a._v("#")]),a._v(" 基本使用：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('1 通过.bash_history查看帐号执行过的系统命令\n2 1 、root的历史命令\n3 histroy\n4 2 、打开/home各帐号目录下的.bash_history，查看普通帐号的历史命令\n5 为历史的命令增加登录的IP地址、执行命令时间等信息：\n6 1 ）保存 1 万条命令\n7 sed -i \'s/^HISTSIZE=1000/HISTSIZE=10000/g\' /etc/profile\n8 2 ）在/etc/profile的文件尾部添加如下行数配置信息：\n9 ######jiagu history#########\n10 USER_IP=`who -u am i 2>/dev/null | awk \'{print $NF}\' | sed -e \'s/[()]//g\'`\n11 if [ "$USER_IP" = "" ]\n12 then\n13 USER_IP=`hostname`\n14 fi\n15 export HISTTIMEFORMAT="%F %T $USER_IP `whoami` "\n16 shopt -s histappend\n17 export PROMPT_COMMAND="history -a"\n18 #########jiagu history##########\n19 3 ）source /etc/profile让配置生效\n20 生成效果： 1 2018 - 07 - 10 19 : 45 : 39 192.168.204.1 root source /etc/profile\n21 3 、历史操作命令的清除：history -c\n22 但此命令并不会清除保存在文件中的记录，因此需要手动删除.bash_profile文件中的记录。\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br")])]),t("h3",{attrs:{id:"_23"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_23"}},[a._v("#")]),a._v(" 23")]),a._v(" "),t("h3",{attrs:{id:"入侵排查-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#入侵排查-2"}},[a._v("#")]),a._v(" 入侵排查：")]),a._v(" "),t("h3",{attrs:{id:"使用netstat-网络连接命令-分析可疑端口、ip、pid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用netstat-网络连接命令-分析可疑端口、ip、pid"}},[a._v("#")]),a._v(" 使用netstat 网络连接命令，分析可疑端口、IP、PID")]),a._v(" "),t("h4",{attrs:{id:"_1-进入用户目录下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-进入用户目录下"}},[a._v("#")]),a._v(" 1 进入用户目录下")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("2 cat .bash_history >> history.txt\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"_1-3-检查异常端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-检查异常端口"}},[a._v("#")]),a._v(" 1. 3 检查异常端口")]),a._v(" "),t("h3",{attrs:{id:"使用netstat-网络连接命令-分析可疑端口、ip、pid-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用netstat-网络连接命令-分析可疑端口、ip、pid-2"}},[a._v("#")]),a._v(" 使用netstat 网络连接命令，分析可疑端口、IP、PID")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 netstat -antlp|more\n2 查看下pid所对应的进程文件路径，\n3 运行ls -l /proc/$PID/exe或file /proc/$PID/exe（$PID 为对应的pid 号）\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"_4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4"}},[a._v("#")]),a._v(" 4")]),a._v(" "),t("h2",{attrs:{id:"_1-4-检查异常进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-检查异常进程"}},[a._v("#")]),a._v(" 1. 4 检查异常进程")]),a._v(" "),t("h3",{attrs:{id:"使用ps命令-分析进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用ps命令-分析进程"}},[a._v("#")]),a._v(" 使用ps命令，分析进程")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 ps aux | grep pid\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"_1-5-检查开机启动项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-检查开机启动项"}},[a._v("#")]),a._v(" 1. 5 检查开机启动项")]),a._v(" "),t("h3",{attrs:{id:"基本使用-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用-3"}},[a._v("#")]),a._v(" 基本使用：")]),a._v(" "),t("h3",{attrs:{id:"系统运行级别示意图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统运行级别示意图"}},[a._v("#")]),a._v(" 系统运行级别示意图：")]),a._v(" "),t("h3",{attrs:{id:"查看运行级别命令-runlevel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看运行级别命令-runlevel"}},[a._v("#")]),a._v(" 查看运行级别命令 runlevel")]),a._v(" "),t("h3",{attrs:{id:"系统默认允许级别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统默认允许级别"}},[a._v("#")]),a._v(" 系统默认允许级别")]),a._v(" "),t("h4",{attrs:{id:"运行级别-含义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行级别-含义"}},[a._v("#")]),a._v(" 运行级别 含义")]),a._v(" "),t("h4",{attrs:{id:"_0-关机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-关机"}},[a._v("#")]),a._v(" 0 关机")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 单用户模式，可以想象为windows的安全模式，主要用于系统\n2 不完全的命令行模式，不含NFS服务\n3 完全的命令行模式，就是标准字符界面\n4 系统保留\n5 图形模式\n6 重启动\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 vi /etc/inittab\n2 id= 3 ：initdefault 系统开机后直接进入哪个运行级别\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"开机启动配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开机启动配置文件"}},[a._v("#")]),a._v(" 开机启动配置文件")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 /etc/rc.local\n2 /etc/rc.d/rc[ 0 ~ 6 ].d\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"例子-当我们需要开机启动自己的脚本时-只需要将可执行脚本丢在-etc-init-d目录下-然后"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#例子-当我们需要开机启动自己的脚本时-只需要将可执行脚本丢在-etc-init-d目录下-然后"}},[a._v("#")]),a._v(" 例子:当我们需要开机启动自己的脚本时，只需要将可执行脚本丢在/etc/init.d目录下，然后")]),a._v(" "),t("h3",{attrs:{id:"在-etc-rc-d-rc-d中建立软链接即可"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-etc-rc-d-rc-d中建立软链接即可"}},[a._v("#")]),a._v(" 在/etc/rc.d/rc*.d中建立软链接即可")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"此处sshd是具体服务的脚本文件-s100ssh是其软链接-s开头代表加载时自启动-如果是k开头的脚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#此处sshd是具体服务的脚本文件-s100ssh是其软链接-s开头代表加载时自启动-如果是k开头的脚"}},[a._v("#")]),a._v(" 此处sshd是具体服务的脚本文件，S100ssh是其软链接，S开头代表加载时自启动；如果是K开头的脚")]),a._v(" "),t("h3",{attrs:{id:"本文件-代表运行级别加载时需要关闭的。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本文件-代表运行级别加载时需要关闭的。"}},[a._v("#")]),a._v(" 本文件，代表运行级别加载时需要关闭的。")]),a._v(" "),t("h3",{attrs:{id:"入侵排查-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#入侵排查-3"}},[a._v("#")]),a._v(" 入侵排查：")]),a._v(" "),t("h3",{attrs:{id:"启动项文件-more-etc-rc-local-etc-rc-d-rc-0-6-d-ls-l-etc-rc-d-rc3-d"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动项文件-more-etc-rc-local-etc-rc-d-rc-0-6-d-ls-l-etc-rc-d-rc3-d"}},[a._v("#")]),a._v(" 启动项文件： more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/")]),a._v(" "),t("h2",{attrs:{id:"_1-6-检查定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-检查定时任务"}},[a._v("#")]),a._v(" 1. 6 检查定时任务")]),a._v(" "),t("h3",{attrs:{id:"基本使用-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用-4"}},[a._v("#")]),a._v(" 基本使用")]),a._v(" "),t("h3",{attrs:{id:"_1-、利用crontab创建计划任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-、利用crontab创建计划任务"}},[a._v("#")]),a._v(" 1 、利用crontab创建计划任务")]),a._v(" "),t("h3",{attrs:{id:"基本命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[a._v("#")]),a._v(" 基本命令")]),a._v(" "),t("h3",{attrs:{id:"crontab-l-列出某个用户cron服务的详细内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-l-列出某个用户cron服务的详细内容"}},[a._v("#")]),a._v(" crontab -l 列出某个用户cron服务的详细内容")]),a._v(" "),t("h3",{attrs:{id:"tips-默认编写的crontab文件会保存在-var-spool-cron-用户名-例如-var-spool-cron-root"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tips-默认编写的crontab文件会保存在-var-spool-cron-用户名-例如-var-spool-cron-root"}},[a._v("#")]),a._v(" Tips：默认编写的crontab文件会保存在 (/var/spool/cron/用户名 例如: /var/spool/cron/root")]),a._v(" "),t("h3",{attrs:{id:"crontab-r-删除每个用户cront任务-谨慎-删除所有的计划任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-r-删除每个用户cront任务-谨慎-删除所有的计划任务"}},[a._v("#")]),a._v(" crontab -r 删除每个用户cront任务(谨慎：删除所有的计划任务)")]),a._v(" "),t("h3",{attrs:{id:"crontab-e-使用编辑器编辑当前的crontab文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab-e-使用编辑器编辑当前的crontab文件"}},[a._v("#")]),a._v(" crontab -e 使用编辑器编辑当前的crontab文件")]),a._v(" "),t("h3",{attrs:{id:"如-1-echo-hello-world-tmp-test-txt-每分钟写入文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如-1-echo-hello-world-tmp-test-txt-每分钟写入文件"}},[a._v("#")]),a._v(" 如：*/1 * * * * echo “hello world” >> /tmp/test.txt 每分钟写入文件")]),a._v(" "),t("h3",{attrs:{id:"_2-、利用anacron实现异步定时任务调度"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-、利用anacron实现异步定时任务调度"}},[a._v("#")]),a._v(" 2 、利用anacron实现异步定时任务调度")]),a._v(" "),t("h3",{attrs:{id:"使用案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用案例"}},[a._v("#")]),a._v(" 使用案例")]),a._v(" "),t("h3",{attrs:{id:"每天运行-home-backup-sh脚本-vi-etc-anacrontab-daily-10-example-daily-bin-bash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#每天运行-home-backup-sh脚本-vi-etc-anacrontab-daily-10-example-daily-bin-bash"}},[a._v("#")]),a._v(" 每天运行 /home/backup.sh脚本： vi /etc/anacrontab @daily 10 example.daily /bin/bash")]),a._v(" "),t("h3",{attrs:{id:"home-backup-sh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#home-backup-sh"}},[a._v("#")]),a._v(" /home/backup.sh")]),a._v(" "),t("h3",{attrs:{id:"当机器在-backup-sh-期望被运行时是关机的-anacron会在机器开机十分钟之后运行它-而不用再等"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#当机器在-backup-sh-期望被运行时是关机的-anacron会在机器开机十分钟之后运行它-而不用再等"}},[a._v("#")]),a._v(" 当机器在 backup.sh 期望被运行时是关机的，anacron会在机器开机十分钟之后运行它，而不用再等")]),a._v(" "),t("h3",{attrs:{id:"待-7-天。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#待-7-天。"}},[a._v("#")]),a._v(" 待 7 天。")]),a._v(" "),t("h3",{attrs:{id:"入侵排查-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#入侵排查-4"}},[a._v("#")]),a._v(" 入侵排查")]),a._v(" "),t("h3",{attrs:{id:"重点关注以下目录中是否存在恶意脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重点关注以下目录中是否存在恶意脚本"}},[a._v("#")]),a._v(" 重点关注以下目录中是否存在恶意脚本")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 /var/spool/cron/*\n2 /etc/crontab\n3 /etc/cron.d/*\n4 /etc/cron.daily/*\n5 /etc/cron.hourly/*\n6 /etc/cron.monthly/*\n7 /etc/cron.weekly/\n8 /etc/anacrontab\n9 /var/spool/anacron/*\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br")])]),t("h3",{attrs:{id:"小技巧"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小技巧"}},[a._v("#")]),a._v(" 小技巧：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 more /etc/cron.daily/* 查看目录下所有文件\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"_1-7-检查服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-检查服务"}},[a._v("#")]),a._v(" 1. 7 检查服务")]),a._v(" "),t("h3",{attrs:{id:"服务自启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务自启动"}},[a._v("#")]),a._v(" 服务自启动")]),a._v(" "),t("h3",{attrs:{id:"第一种修改方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第一种修改方法"}},[a._v("#")]),a._v(" 第一种修改方法：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 chkconfig [--level 运行级别] [独立服务名] [on|off]\n2 chkconfig –level 2345 httpd on 开启自启动\n3 chkconfig httpd on （默认level是 2345 ）\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"第二种修改方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第二种修改方法"}},[a._v("#")]),a._v(" 第二种修改方法：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 修改/etc/re.d/rc.local 文件\n2 加入 /etc/init.d/httpd start\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"第三种修改方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三种修改方法"}},[a._v("#")]),a._v(" 第三种修改方法：")]),a._v(" "),t("h3",{attrs:{id:"使用ntsysv命令管理自启动-可以管理独立服务和xinetd服务。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用ntsysv命令管理自启动-可以管理独立服务和xinetd服务。"}},[a._v("#")]),a._v(" 使用ntsysv命令管理自启动，可以管理独立服务和xinetd服务。")]),a._v(" "),t("h3",{attrs:{id:"入侵排查-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#入侵排查-5"}},[a._v("#")]),a._v(" 入侵排查")]),a._v(" "),t("h3",{attrs:{id:"_1-、查询已安装的服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-、查询已安装的服务"}},[a._v("#")]),a._v(" 1 、查询已安装的服务：")]),a._v(" "),t("h3",{attrs:{id:"rpm包安装的服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rpm包安装的服务"}},[a._v("#")]),a._v(" RPM包安装的服务")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 chkconfig --list 查看服务自启动状态，可以看到所有的RPM包安装的服务\n2 ps aux | grep crond 查看当前服务\n3 系统在 3 与 5 级别下的启动项\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h4",{attrs:{id:"_4-中文环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-中文环境"}},[a._v("#")]),a._v(" 4 中文环境")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('5 chkconfig --list | grep "3:启用\\|5:启用"\n6 英文环境\n7 chkconfig --list | grep "3:on\\|5:on"\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"源码包安装的服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#源码包安装的服务"}},[a._v("#")]),a._v(" 源码包安装的服务")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 查看服务安装位置 ，一般是在/user/local/\n2 service httpd start\n3 搜索/etc/rc.d/init.d/ 查看是否存在\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h2",{attrs:{id:"_1-8-检查异常文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-检查异常文件"}},[a._v("#")]),a._v(" 1. 8 检查异常文件")]),a._v(" "),t("h3",{attrs:{id:"_1-、查看敏感目录-如-tmp目录下的文件-同时注意隐藏文件夹-以-为名的文件夹具有隐藏属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-、查看敏感目录-如-tmp目录下的文件-同时注意隐藏文件夹-以-为名的文件夹具有隐藏属性"}},[a._v("#")]),a._v(" 1 、查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，以“...”为名的文件夹具有隐藏属性")]),a._v(" "),t("h3",{attrs:{id:"_2-、得到发现webshell、远控木⻢的创建时间-如何找出同一时间范围内创建的文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-、得到发现webshell、远控木⻢的创建时间-如何找出同一时间范围内创建的文件"}},[a._v("#")]),a._v(" 2 、得到发现WEBSHELL、远控木⻢的创建时间，如何找出同一时间范围内创建的文件？")]),a._v(" "),t("h3",{attrs:{id:"可以使用find命令来查找-如-find-opt-iname-atime-1-type-f-找出-opt-下一天前访问过的文"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可以使用find命令来查找-如-find-opt-iname-atime-1-type-f-找出-opt-下一天前访问过的文"}},[a._v("#")]),a._v(" 可以使用find命令来查找，如 find /opt -iname “*” -atime 1 -type f 找出 /opt 下一天前访问过的文")]),a._v(" "),t("h3",{attrs:{id:"件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#件"}},[a._v("#")]),a._v(" 件")]),a._v(" "),t("h3",{attrs:{id:"_3-、针对可疑文件可以使用stat进行创建修改时间。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-、针对可疑文件可以使用stat进行创建修改时间。"}},[a._v("#")]),a._v(" 3 、针对可疑文件可以使用stat进行创建修改时间。")]),a._v(" "),t("h2",{attrs:{id:"_1-9-检查系统日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-9-检查系统日志"}},[a._v("#")]),a._v(" 1. 9 检查系统日志")]),a._v(" "),t("h3",{attrs:{id:"日志默认存放位置-var-log"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志默认存放位置-var-log"}},[a._v("#")]),a._v(" 日志默认存放位置：/var/log/")]),a._v(" "),t("h3",{attrs:{id:"查看日志配置情况-more-etc-rsyslog-conf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看日志配置情况-more-etc-rsyslog-conf"}},[a._v("#")]),a._v(" 查看日志配置情况：more /etc/rsyslog.conf")]),a._v(" "),t("h3",{attrs:{id:"日志分析技巧"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志分析技巧"}},[a._v("#")]),a._v(" 日志分析技巧：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('1 1 、定位有多少IP在爆破主机的root帐号：\n2 grep "Failed password for root" /var/log/secure | awk \'{print $11}\' | sort | uniq\n3 | more\n4 定位有哪些IP在爆破：\n5 grep "Failed password" /var/log/secure|grep -E - o "( 25 [ 0 - 5 ]| 2 [ 0 - 4 ][ 0 - 9 ]|[ 01 ]?[ 0 - 9\n6 [ 0 - 9 ]|[ 01 ]?[ 0 - 9 ][ 0 - 9 ]?)"|uniq -c\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h3",{attrs:{id:"_7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7"}},[a._v("#")]),a._v(" 7")]),a._v(" "),t("h4",{attrs:{id:"_8-爆破用户名字典是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-爆破用户名字典是什么"}},[a._v("#")]),a._v(" 8 爆破用户名字典是什么？")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("9 grep \"Failed password\" /var/log/secure|perl -e 'while($_=<>){ /for(.*?) from/; pr\n10 \"$1\\n\";}'|uniq -c|sort -nr\n11 2 、登录成功的IP有哪些：\n12 grep \"Accepted \" /var/log/secure | awk '{print $11}' | sort | uniq -c | sort -nr\n13 登录成功的日期、用户名、IP：\n14 grep \"Accepted \" /var/log/secure | awk '{print $1,$2,$3,$9,$11}'\n15 3 、增加一个用户kali日志：\n16 Jul 10 00 : 12 : 15 localhost useradd[ 2382 ]: new group: name=kali, GID= 1001\n17 Jul 10 00 : 12 : 15 localhost useradd[ 2382 ]: new user: name=kali, UID= 1001 , GID= 1001 ,\n18 home=/home/kali\n19 , shell=/bin/bash\n20 Jul 10 00 : 12 : 58 localhost passwd: pam_unix(passwd:chauthtok): password changed fo\n21 #grep \"useradd\" /var/log/secure\n22 4 、删除用户kali日志：\n23 Jul 10 00 : 14 : 17 localhost userdel[ 2393 ]: delete user 'kali'\n24 Jul 10 00 : 14 : 17 localhost userdel[ 2393 ]: removed group 'kali' owned by 'kali'\n25 Jul 10 00 : 14 : 17 localhost userdel[ 2393 ]: removed shadow group 'kali' owned by 'ka\n26 # grep \"userdel\" /var/log/secure\n27 5 、su切换用户：\n28 Jul 10 00 : 38 : 13 localhost su: pam_unix(su-l:session): session opened for user goo\n29 root(uid= 0 )\n30 sudo授权执行:\n31 sudo -l\n32 Jul 10 00 : 43 : 09 localhost sudo: good : TTY=pts/ 4 ; PWD=/home/good ; USER=root ;\n33 COMMAND=/sbin/shutdown -r now\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br"),t("span",{staticClass:"line-number"},[a._v("25")]),t("br")])]),t("h3",{attrs:{id:"_34"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_34"}},[a._v("#")]),a._v(" 34")]),a._v(" "),t("h1",{attrs:{id:"_0x-02-工具篇"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0x-02-工具篇"}},[a._v("#")]),a._v(" 0x 02 工具篇")]),a._v(" "),t("h2",{attrs:{id:"_2-1-rootkit查杀"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-rootkit查杀"}},[a._v("#")]),a._v(" 2. 1 Rootkit查杀")]),a._v(" "),t("h3",{attrs:{id:"chkrootkit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chkrootkit"}},[a._v("#")]),a._v(" chkrootkit")]),a._v(" "),t("h3",{attrs:{id:"网址-http-www-chkrootkit-org"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网址-http-www-chkrootkit-org"}},[a._v("#")]),a._v(" 网址：http://www.chkrootkit.org")]),a._v(" "),t("h4",{attrs:{id:"_1-使用方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用方法"}},[a._v("#")]),a._v(" 1 使用方法：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("2 wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz\n3 tar zxvf chkrootkit.tar.gz\n4 cd chkrootkit-0.\n5 make sense\n6 #编译完成没有报错的话执行检查\n7 ./chkrootkit\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h3",{attrs:{id:"rkhunter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rkhunter"}},[a._v("#")]),a._v(" rkhunter")]),a._v(" "),t("h3",{attrs:{id:"网址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#网址"}},[a._v("#")]),a._v(" 网址：")]),a._v(" "),t("h4",{attrs:{id:"_1-使用方法-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用方法-2"}},[a._v("#")]),a._v(" 1 使用方法：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("2 Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.\n3 tar -zxvf rkhunter-1.4.4.tar.gz\n4 cd rkhunter-1.4.\n5 ./installer.sh --install\n6 rkhunter -c\n7\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h2",{attrs:{id:"_2-2-病毒查杀"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-病毒查杀"}},[a._v("#")]),a._v(" 2. 2 病毒查杀")]),a._v(" "),t("h3",{attrs:{id:"clamav"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clamav"}},[a._v("#")]),a._v(" Clamav")]),a._v(" "),t("h3",{attrs:{id:"clamav的官方下载地址为-http-www-clamav-net-download-html"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clamav的官方下载地址为-http-www-clamav-net-download-html"}},[a._v("#")]),a._v(" ClamAV的官方下载地址为：http://www.clamav.net/download.html")]),a._v(" "),t("h3",{attrs:{id:"安装方式一"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装方式一"}},[a._v("#")]),a._v(" 安装方式一：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('1 1 、安装zlib：\n2 wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz\n3 tar -zxvf zlib-1.2.7.tar.gz\n4 cd zlib-1.2.\n5 #安装一下gcc编译环境： yum install gcc\n6 CFLAGS="-O3 -fPIC" ./configure --prefix= /usr/local/zlib/\n7 make && make install\n8 2 、添加用户组clamav和组成员clamav：\n9 groupadd clamav\n10 useradd -g clamav -s /bin/false - c "Clam AntiVirus" clamav\n11 3 、安装Clamav\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br")])]),t("h3",{attrs:{id:"http-rkhunter-sourceforge-net"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#http-rkhunter-sourceforge-net"}},[a._v("#")]),a._v(" http://rkhunter.sourceforge.net")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("12 tar –zxvf clamav-0.97.6.tar.gz\n13 cd clamav-0.97.\n14 ./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib\n15 make\n16 make install\n17 4 、配置Clamav\n18 mkdir /opt/clamav/logs\n19 mkdir /opt/clamav/updata\n20 touch /opt/clamav/logs/freshclam.log\n21 touch /opt/clamav/logs/clamd.log\n22 cd /opt/clamav/logs\n23 chown clamav:clamav clamd.log\n24 chown clamav:clamav freshclam.log\n25 5 、ClamAV 使用：\n26 /opt/clamav/bin/freshclam 升级病毒库\n27 ./clamscan –h 查看相应的帮助信息\n28 ./clamscan -r /home 扫描所有用户的主目录就使用\n29 ./clamscan -r --bell -i /bin 扫描bin目录并且显示有问题的文件的扫描结果\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br")])]),t("h3",{attrs:{id:"_30"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_30"}},[a._v("#")]),a._v(" 30")]),a._v(" "),t("h3",{attrs:{id:"安装方式二"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装方式二"}},[a._v("#")]),a._v(" 安装方式二：")]),a._v(" "),t("h4",{attrs:{id:"_1-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装"}},[a._v("#")]),a._v(" 1 #安装")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("2 yum install -y clamav\n3 #更新病毒库\n4 freshclam\n5 #扫描方法\n6 clamscan -r /etc --max-dir-recursion= 5 - l /root/etcclamav.log\n7 clamscan -r /bin --max-dir-recursion= 5 - l /root/binclamav.log\n8 clamscan -r /usr --max-dir-recursion= 5 - l /root/usrclamav.log\n9 #扫描并杀毒\n10 clamscan -r --remove /usr/bin/bsd-port\n11 clamscan -r --remove /usr/bin/\n12 clamscan -r --remove /usr/local/zabbix/sbin\n13 #查看日志发现\n14 cat /root/usrclamav.log |grep FOUND\n15\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br")])]),t("h2",{attrs:{id:"_2-3-webshell查杀"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-webshell查杀"}},[a._v("#")]),a._v(" 2. 3 webshell查杀")]),a._v(" "),t("h3",{attrs:{id:"linux版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux版"}},[a._v("#")]),a._v(" linux版：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 河⻢webshell查杀：http://www.shellpub.com\n2 深信服Webshell网站后⻔检测工具：http://edr.sangfor.com.cn/backdoor_detection.html\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h2",{attrs:{id:"_2-4-rpm-check检查"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-rpm-check检查"}},[a._v("#")]),a._v(" 2. 4 RPM check检查")]),a._v(" "),t("h3",{attrs:{id:"系统完整性可以通过rpm自带的-va来校验检查所有的rpm软件包-查看哪些命令是否被替换了"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统完整性可以通过rpm自带的-va来校验检查所有的rpm软件包-查看哪些命令是否被替换了"}},[a._v("#")]),a._v(" 系统完整性可以通过rpm自带的-Va来校验检查所有的rpm软件包，查看哪些命令是否被替换了：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1 ./rpm -Va > rpm.log\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"如果一切均校验正常将不会产生任何输出-如果有不一致的地方-就会显示出来-输出格式是-8-位⻓字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如果一切均校验正常将不会产生任何输出-如果有不一致的地方-就会显示出来-输出格式是-8-位⻓字"}},[a._v("#")]),a._v(" 如果一切均校验正常将不会产生任何输出，如果有不一致的地方，就会显示出来，输出格式是 8 位⻓字")]),a._v(" "),t("h3",{attrs:{id:"符串-每个字符都用以表示文件与rpm数据库中一种属性的比较结果-如果是-点-则表示测试通"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#符串-每个字符都用以表示文件与rpm数据库中一种属性的比较结果-如果是-点-则表示测试通"}},[a._v("#")]),a._v(" 符串，每个字符都用以表示文件与RPM数据库中一种属性的比较结果 ，如果是. (点) 则表示测试通")]),a._v(" "),t("h3",{attrs:{id:"过。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过。"}},[a._v("#")]),a._v(" 过。")]),a._v(" "),t("h4",{attrs:{id:"_1-验证内容中的-8-个信息的具体内容如下"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-验证内容中的-8-个信息的具体内容如下"}},[a._v("#")]),a._v(" 1 验证内容中的 8 个信息的具体内容如下：")]),a._v(" "),t("h4",{attrs:{id:"_2-s-文件大小是否改变"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-s-文件大小是否改变"}},[a._v("#")]),a._v(" 2 S 文件大小是否改变")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("3 M 文件的类型或文件的权限（rwx）是否被改变\n4 5 文件MD5校验是否改变（可以看成文件内容是否改变）\n5 D 设备中，从代码是否改变\n6 L 文件路径是否改变\n7 U 文件的属主（所有者）是否改变\n8 G 文件的属组是否改变\n9 T 文件的修改时间是否改变\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("h3",{attrs:{id:"_10"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10"}},[a._v("#")]),a._v(" 10")]),a._v(" "),t("h3",{attrs:{id:"如果命令被替换了-如何还原回来"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如果命令被替换了-如何还原回来"}},[a._v("#")]),a._v(" 如果命令被替换了，如何还原回来：")]),a._v(" "),t("h4",{attrs:{id:"_1-文件提取还原案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-文件提取还原案例"}},[a._v("#")]),a._v(" 1 文件提取还原案例：")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("2 rpm -qf /bin/ls 查询ls命令属于哪个软件包\n3 mv /bin/ls /tmp 先把ls转移到tmp目录下，造成ls命令丢失的假象\n4 rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls 提\n5 到当前目录的/bin/ls下\n6 cp /root/bin/ls /bin/ 把ls命令复制到/bin/目录 修复文件丢失\n7\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h2",{attrs:{id:"_2-5-linux安全检查脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-linux安全检查脚本"}},[a._v("#")]),a._v(" 2. 5 linux安全检查脚本")]),a._v(" "),t("h3",{attrs:{id:"github项目地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#github项目地址"}},[a._v("#")]),a._v(" Github项目地址：")]),a._v(" "),t("h3",{attrs:{id:"https-github-com-grayddq-gscan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https-github-com-grayddq-gscan"}},[a._v("#")]),a._v(" https://github.com/grayddq/GScan")]),a._v(" "),t("h3",{attrs:{id:"https-github-com-ppabc-security-check"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https-github-com-ppabc-security-check"}},[a._v("#")]),a._v(" https://github.com/ppabc/security_check")]),a._v(" "),t("h3",{attrs:{id:"https-github-com-t0xst-linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#https-github-com-t0xst-linux"}},[a._v("#")]),a._v(" https://github.com/T0xst/linux")]),a._v(" "),t("h3",{attrs:{id:"工具只是辅助-别太过于依赖-关键在于你如何解决问题的思路。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#工具只是辅助-别太过于依赖-关键在于你如何解决问题的思路。"}},[a._v("#")]),a._v(" 工具只是辅助，别太过于依赖，关键在于你如何解决问题的思路。")])])}),[],!1,null,null,null);s.default=e.exports}}]);